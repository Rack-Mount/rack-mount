@if (mode() === "single") {
  <!-- ── Single-remove popover ─────────────────────── -->
  <div class="rack-remove-backdrop" (click)="close()"></div>
  <div
    class="rack-remove-confirm"
    [style.top.px]="anchorY()"
    [style.left.px]="anchorX()"
    (click)="$event.stopPropagation()"
  >
    @if (_saving()) {
      <div class="rack-remove-confirm__saving">
        {{ "remove_confirm.removing" | translate }}
      </div>
    } @else {
      <p class="rack-remove-confirm__msg">
        {{ "remove_confirm.single_msg" | translate }}
      </p>
      @if (decommissionedStateId()) {
        <p class="rack-remove-confirm__note">
          {{ "remove_confirm.decommissioned_note" | translate }}
        </p>
      }
      <div class="rack-remove-confirm__actions">
        <button
          class="rack-remove-confirm__btn rack-remove-confirm__btn--cancel"
          (click)="close()"
        >
          {{ "common.cancel" | translate }}
        </button>
        <button
          class="rack-remove-confirm__btn rack-remove-confirm__btn--confirm"
          (click)="executeSingleRemove()"
        >
          {{ "remove_confirm.remove" | translate }}
        </button>
      </div>
    }
  </div>
}

@if (mode() === "bulk") {
  <!-- ── Bulk-remove modal ─────────────────────────── -->
  <div class="rack-modal-backdrop" (click)="close()"></div>
  <div class="rack-modal" (click)="$event.stopPropagation()">
    @if (_saving()) {
      <div class="rack-modal__saving">
        {{
          "remove_confirm.removing_bulk" | translate: { count: selectedCount() }
        }}
      </div>
    } @else {
      <div class="rack-modal__icon">
        <svg viewBox="0 0 20 20" fill="currentColor" width="28" height="28">
          <path
            fill-rule="evenodd"
            d="M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z"
            clip-rule="evenodd"
          />
        </svg>
      </div>
      <p class="rack-modal__title">
        {{
          "remove_confirm.bulk_title" | translate: { count: selectedCount() }
        }}
      </p>
      <p class="rack-modal__sub">
        {{ "remove_confirm.bulk_sub" | translate }}
        @if (decommissionedStateId()) {
          {{ "remove_confirm.decommissioned_bulk_note" | translate }}
        }
      </p>
      <div class="rack-modal__actions">
        <button
          class="rack-modal__btn rack-modal__btn--cancel"
          (click)="close()"
        >
          {{ "common.cancel" | translate }}
        </button>
        <button
          class="rack-modal__btn rack-modal__btn--confirm"
          (click)="executeBulkRemove()"
        >
          {{
            "remove_confirm.remove_bulk" | translate: { count: selectedCount() }
          }}
        </button>
      </div>
    }
  </div>
}

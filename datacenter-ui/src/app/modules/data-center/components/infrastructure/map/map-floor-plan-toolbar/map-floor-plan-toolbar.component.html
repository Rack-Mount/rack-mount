<div class="floor-plan-toolbar">
  @if (roomId()) {
    <span class="toolbar-info-label">Location:</span>
    <span class="toolbar-info-value">{{ selectedLocationName() }}</span>
    <span class="toolbar-info-sep"></span>
    <span class="toolbar-info-label">Room:</span>
    <span class="toolbar-info-value">{{ selectedRoomName() }}</span>
  } @else {
    <label for="location-select">Location:</label>
    <select
      id="location-select"
      [ngModel]="selectedLocationId()"
      (ngModelChange)="locationChange.emit($event)"
    >
      <option [ngValue]="null">
        {{ "map_toolbar.select_location" | translate }}
      </option>
      @for (loc of locations(); track loc.id) {
        <option [ngValue]="loc.id">{{ loc.name }}</option>
      }
    </select>
    <label for="room-select">Room:</label>
    <select
      id="room-select"
      [disabled]="!selectedLocationId()"
      [ngModel]="selectedRoomId()"
      (ngModelChange)="roomChange.emit($event)"
    >
      <option [ngValue]="null">
        {{ "map_toolbar.select_room" | translate }}
      </option>
      @for (room of rooms(); track room.id) {
        <option [ngValue]="room.id">{{ room.name }}</option>
      }
    </select>
  }

  <button
    class="btn-save"
    (click)="save.emit()"
    [disabled]="!selectedRoomId() || saveStatus() === 'saving'"
  >
    {{
      saveStatus() === "saving"
        ? ("map_toolbar.saving" | translate)
        : ("map_toolbar.save" | translate)
    }}
  </button>

  <label class="autosave-toggle">
    <input
      type="checkbox"
      [checked]="autosave()"
      (change)="autosaveChange.emit($any($event.target).checked)"
    />
    <span class="switch-track">
      <span class="switch-thumb"></span>
    </span>
    <span class="switch-label">{{ "map_toolbar.autosave" | translate }}</span>
  </label>

  @if (saveStatus() === "saved") {
    <span class="save-feedback save-ok">{{
      "map_toolbar.saved_ok" | translate
    }}</span>
  }
  @if (saveStatus() === "error") {
    <span class="save-feedback save-err">{{
      "map_toolbar.save_error" | translate
    }}</span>
  }

  @if (activeTool() === "rack") {
    <span class="rack-picker-sep"></span>
    <label for="rack-select" class="rack-picker-label"
      >üñ•Ô∏è {{ "map_toolbar.rack_model_label" | translate }}</label
    >
    @if (rackTypes().length === 0) {
      <span class="rack-picker-empty">{{
        "map_toolbar.no_rack_models" | translate
      }}</span>
    } @else {
      <select
        id="rack-select"
        class="rack-picker-select"
        [ngModel]="selectedRackType()"
        (ngModelChange)="rackTypeChange.emit($event)"
      >
        @for (rackType of rackTypes(); track rackType.id) {
          <option [ngValue]="rackType">
            {{ rackType.model }} ({{ rackType.width }}√ó{{ rackType.height }} cm,
            {{ rackType.capacity }}U)
          </option>
        }
      </select>
    }
  }

  @if (activeTool() === "door") {
    <span class="rack-picker-sep"></span>
    <label class="rack-picker-label"
      >üö™ {{ "map_toolbar.door_label" | translate }}</label
    >
    <input
      type="number"
      class="door-width-input"
      [ngModel]="doorWidth()"
      (ngModelChange)="doorWidthChange.emit($event)"
      min="20"
      max="2000"
      step="10"
    />
    <span class="rack-picker-label">{{
      "map_toolbar.door_unit" | translate
    }}</span>
  }
</div>
